Ext.require(["Ext.form.*","Ext.panel.*","Ext.tip.*"]);gender_store=[["M","Male"],["F","Female"]];reason_of_request_store=[[1,"Replacement"],[2,"Reliever"],[3,"Special Project"],[4,"Additional Staff"]];replacement_fieldset={title:"Replacement",items:[{xtype:"radiogroup",defaults:{width:150},items:[{name:"replacement_for",boxLabel:"Transfer"},{name:"replacement_for",boxLabel:"Resignation"},{name:"replacement_for",boxLabel:"Termination"},{name:"replacement_for",boxLabel:"End of Contract"}]}]};
special_project_fieldset={title:"Special Project",items:[{xtype:"textarea",fieldLabel:"PROJECT DESCRIPTION",labelAlign:"top",width:880,name:"project_description"}]};
reliever_fieldset={title:"Reliever",defaultType:"panel",defaults:{layout:"column",border:false,frame:false,bodyStyle:"background-color:transparent;",defaultType:"mytextfield",defaults:{enableKeyEvents:true,style:"margin:0 25px 5px 0"}},items:[{items:[{fieldLabel:"Badge No.",name:"employee_badge_no",labelWidth:90,width:200},{fieldLabel:"Name",name:"employee_name",labelWidth:50,width:300},{fieldLabel:"Position",name:"employee_position",labelWidth:75,width:325},{fieldLabel:"Duration of Leave",name:"duration_of_leave",
labelWidth:90,width:200}]},{items:[{xtype:"textarea",fieldLabel:"REASON OF EXTENDED LEAVE",name:"extended_leave_reason",labelAlign:"top",width:880}]}]};justification=[{xtype:"textarea",fieldLabel:"JUSTIFICATION",name:"justification",labelAlign:"top",width:880},{xtype:"filefield",fieldLabel:"Upload File for Justification",name:"justification_file",id:"justification_file",width:880}];
additional_staff_fieldset={title:"Additional Staff",layout:"column",items:[{fieldLabel:"Position",name:"additional_staff_position",labelWidth:90,width:340},{xtype:"radiogroup",fieldLabel:"Within Plantilla",labelWidth:90,width:200,items:[{boxLabel:"Yes",inputValue:1,name:"within_platilla"},{boxLabel:"No",inputValue:0,name:"within_platilla"}],listeners:{change:function(){var plantilla_val=this.getValue().within_platilla,my_fieldset=this.findParentByType("fieldset");if(plantilla_val==0)my_fieldset.add(justification);
else if(my_fieldset.getComponent(2)&&my_fieldset.getComponent(3)){my_fieldset.getComponent(2).destroy(true);my_fieldset.getComponent(2).destroy(true)}else return}}}]};
permanent_position_fieldset={title:"Permanent Position",items:[{fieldLabel:"Position Title",name:"permanent_title",store:dropDownStore("getpositions"),displayField:"desc",valueField:"code",width:340,labelWidth:90},{fieldLabel:"Rank/Level",name:"permanent_rank",store:dropDownStore("getgenericlookup"),displayField:"desc",valueField:"code",labelWidth:75,width:230,listeners:{render:function(){this.store.load({params:{app_code:"EMRF",sub_code:"RANKP"}})}}}]};
temporary_position_fieldset={title:"Temporary Position",items:[{fieldLabel:"Position Title",name:"temporary_title",store:dropDownStore("getpositions"),displayField:"desc",valueField:"code",labelWidth:90,width:340},{fieldLabel:"Rank/Level",name:"temporary_rank",store:dropDownStore("getgenericlookup"),displayField:"desc",valueField:"code",labelWidth:75,width:230,listeners:{render:function(){this.store.load({params:{app_code:"EMRF",sub_code:"RANKT"}})}}},{fieldLabel:"Employment Status",name:"employment_status",
width:260,labelWidth:125},{xtype:"datefield",fieldLabel:"<b>Duration of Contract:</b> From",name:"contract_from",labelWidth:180,width:340},{xtype:"datefield",fieldLabel:"To",name:"contract_to",labelWidth:75,width:230}]};
Ext.onReady(function(){request_form=Ext.create("Ext.form.FormPanel",{autoWidth:true,autoHeight:true,border:false,fileUpload:true,frame:false,renderTo:"request-form-container",defaultType:"panel",defaults:{autoHeight:true,autoWidth:true,padding:"10px 10px 10px 10px;",frame:true,border:true,defaultType:"fieldset",defaults:{layout:"column",defaultType:"combobox",defaults:{width:350,labelWidth:150,enableKeyEvents:true,style:"margin:0 25px 5px 0",allowBlank:false}}},items:[{title:"REQUEST DETAILS",padding:"10px 20px 10px 20px",
xtype:"panel",layout:"column",defaults:{style:"margin:0 25px 5px 0",allowBlank:false},items:[{xtype:"combobox",fieldLabel:"Company",name:"company",store:dropDownStore("getcompanies"),invalidCls:"invalid-field",displayField:"desc",valueField:"code",labelWidth:100,width:350},{xtype:"combobox",fieldLabel:"Department",name:"department",store:dropDownStore("getdepartments"),displayField:"desc",valueField:"code",labelWidth:75},{xtype:"numberfield",fieldLabel:"No. of Bodies Needed",name:"needed_number",
labelWidth:125,width:265}]},{title:"Position Details",id:"position_detail_panel",padding:"10px 20px 10px 20px",items:[{xtype:"combobox",fieldLabel:"Position Type",name:"position_type",id:"position_type",store:[[1,"Permanent"],[2,"Temporary"]],allowBlank:false,width:350,labelWidth:100},{xtype:"box",id:"temp"}]},{title:"Reason of Request",id:"request_panel",padding:"10px 20px 10px 20px",items:[{xtype:"combobox",fieldLabel:"Reason of Request",name:"reason_of_request",id:"reason_of_request",store:reason_of_request_store,
emptyText:"Please Select",allowBlank:false,labelWidth:125,width:350},{hidden:true},{xtype:"textarea",fieldLabel:"JOB DESCRIPTION",labelAlign:"top",name:"job_description",width:890,allowBlank:false},{title:"Job Specification",defaultType:"textarea",defaults:{style:"margin:0 20px 10px 0",labelAlign:"top",width:880,allowBlank:false},items:[{xtype:"combobox",fieldLabel:"Educational Attainment",name:"education_attainment",width:430},{xtype:"mytextfield",fieldLabel:"Education Preferred",name:"preferred_education",
width:430},{fieldLabel:"WORK EXPERIENCE",name:"work_experience"},{fieldLabel:"SKILLS REQUIRED",name:"required_skills"},{fieldLabel:"MACHINE OPERATION SKILL REQUIRED",name:"machine_skill"},{fieldLabel:"SOFTWARE/PROGRAMMING SKILLS",name:"software_skill"},{fieldLabel:"OTHER QUALIFICATION",name:"other_qualification"},{xtype:"panel",frame:false,border:false,layout:"column",bodyStyle:"background-color:transparent;",defaults:{allowBlank:false},items:[{xtype:"numberfield",fieldLabel:"<b>AGE RANGE:</b> &emsp;From",
name:"age_from",labelWidth:125,width:200},{width:125,labelWidth:50,labelAlign:"right",xtype:"numberfield",fieldLabel:"To",name:"age_to"},{labelWidth:85,labelAlign:"right",xtype:"combobox",fieldLabel:"Gender",name:"gender",store:gender_store},{labelAlign:"right",xtype:"combobox",fieldLabel:"Salary range",name:"salary_range",width:315}]}]},{xtype:"panel",frame:false,border:false,padding:"25px 0 25px 0",bodyStyle:"background-color:transparent;",layout:"column",defaultType:"displayfield",items:[{fieldLabel:"<b>Requested by</b>",
value:fullname,labelWidth:100,width:300},{fieldLabel:"<b>Position</b>",value:position_desc,labelWidth:75,width:365},{fieldLabel:"<b>Request date</b>",value:_today,labelWidth:100,width:200}]}],buttonAlign:"center",buttons:[submit_btn,clear_btn,cancel_btn]}]});var position_type=Ext.getCmp("position_type"),reason_of_request=Ext.getCmp("reason_of_request"),request_panel=Ext.getCmp("request_panel"),position_detail_panel=Ext.getCmp("position_detail_panel");position_type.on("collapse",function(){var my_val=
this.getValue();position_detail_panel.remove(1);if(my_val==1)position_detail_panel.add(permanent_position_fieldset);else if(my_val==2)position_detail_panel.add(temporary_position_fieldset);else return});reason_of_request.on("collapse",function(){var my_val=this.getValue();if(my_val==1){request_panel.remove(1,true);request_panel.insert(1,replacement_fieldset)}else if(my_val==2){request_panel.remove(1,true);request_panel.insert(1,reliever_fieldset)}else if(my_val==3){request_panel.remove(1,true);request_panel.insert(1,
special_project_fieldset)}else if(my_val==4){request_panel.remove(1,true);request_panel.insert(1,additional_staff_fieldset)}else return});Ext.getCmp("submit_btn").on("click",function(){submitRequestForm("sendMRF")})});